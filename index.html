# 🎯 Stream Rewards Automation - Complete Project Plan

## 📋 **Project Overview**
Create an automated system where:
- Followers/subscribers trigger StreamerBot actions
- Random wallpaper/video rewards are posted as secure, non-spoofable GitHub links
- **Zero manual work** after initial setup - just drop files and click one button

---

## 🛠️ **Technical Architecture**

### **Part 1: GitHub Repository Structure**
```
stream-rewards/
├── index.html                    # File renamer tool + preview
├── manifest.json                 # Auto-generated file mappings (StreamerBot reads this)
└── images/
    ├── follows/                  # Follow reward files
    │   ├── follow_x7k9m2p8.png
    │   ├── follow_n3q8w1r5.jpeg
    │   └── follow_k2m9x4t7.mp4
    └── subs/                     # Sub reward files
        ├── sub_a9b2c5d8.png
        ├── sub_f3g7h1j4.jpeg
        └── sub_m8x2n5p9.mp4
```

### **Part 2: Web Renamer Tool (index.html)**
**Features:**
- **File Scanner**: Automatically detects all files in `images/follows/` and `images/subs/`
- **Multi-Format Support**: Handles `.png`, `.jpeg`, `.jpg`, `.mp4`, `.webp`, `.gif`
- **Bulk Renamer**: One-click rename all files to `[type]_[8randomchars].[ext]`
- **Preview Mode**: Shows old → new names before applying
- **Manifest Generator**: Creates `manifest.json` with file count and mappings
- **GitHub Integration**: Uses GitHub API to rename files directly in repository

### **Part 3: StreamerBot Integration**
**Actions Needed:**
1. **Follow Reward Action**
2. **Sub Reward Action**

**Each Action Contains:**
- **Trigger**: Follow/Subscription event
- **HTTP Request**: Fetch `manifest.json` from GitHub
- **C# Execute Code**: Parse JSON, select random file, post chat link
- **Multiple File Type Handling**: Proper URL generation for images vs videos

---

## 🔧 **Implementation Steps**

### **Phase 1: Repository Setup** ⏱️ *5 minutes*
1. **Create GitHub repository** `stream-rewards` (public)
2. **Enable GitHub Pages** (Settings → Pages → Deploy from branch)
3. **Create folder structure**:
   ```bash
   mkdir -p images/follows images/subs
   ```
4. **Upload initial files** to test folders (any names for now)

### **Phase 2: Web Renamer Tool** ⏱️ *30 minutes*
**File: `index.html`**

**Version Control System:**
- **Header displays current version** for easy refresh confirmation
- **Version increments** with each significant update
- **Feature descriptions** included in version string
- **Current Version:** 1.2.0 - Auto-save Settings & Smart Folder Detection

**Core Functions:**
```javascript
// File discovery (GitHub API or manual upload)
async function scanRepository()

// Crypto-secure random string generator  
function generateSecureRandomString(length = 8)

// Bulk file renaming with preview
function renameAllFiles()

// Manifest generation for StreamerBot
function generateManifest()

// GitHub API integration for remote file operations
async function commitRenamedFiles()
```

**UI Components:**
- **File List Display**: Shows current files with preview
- **"Scan Repository" Button**: Discovers existing files
- **"Preview Rename" Button**: Shows old → new mappings
- **"Apply Changes" Button**: Executes bulk rename + generates manifest
- **Status Display**: Progress indicator and success/error messages

### **Phase 3: StreamerBot Actions** ⏱️ *15 minutes*

#### **Follow Reward Action**
```yaml
Trigger: Twitch Follow
Sub-actions:
  1. HTTP Request: 
     - URL: https://kaypikefashion.github.io/stream-rewards/manifest.json
     - Method: GET
     - Store response in %manifest%
  
  2. Execute C# Code:
     - Parse JSON manifest
     - Get follow files count
     - Generate random number (1 to count)
     - Select random file from follows array
     - Detect file type for chat message formatting
  
  3. Send Chat Message:
     - Format based on file type (image vs video)
     - Post secure GitHub link
```

#### **Sub Reward Action**
```yaml
Trigger: Twitch Subscription  
Sub-actions: [Same as Follow but uses 'subs' folder]
```

### **Phase 4: C# Code for StreamerBot** ⏱️ *20 minutes*

**Key Features:**
- **JSON Parsing**: Handle manifest.json structure
- **File Type Detection**: Different chat messages for images vs videos
- **Error Handling**: Fallback if manifest unavailable
- **Random Selection**: Crypto-secure random number generation

**Sample Structure:**
```csharp
// Parse manifest JSON
var manifest = JsonConvert.DeserializeObject<Manifest>(args["manifest"].ToString());

// Select random follow reward
var followFiles = manifest.follows;
var randomIndex = new Random().Next(0, followFiles.Count);
var selectedFile = followFiles[randomIndex];

// Generate chat message based file type
string fileExtension = Path.GetExtension(selectedFile).ToLower();
string chatMessage = GenerateChatMessage(selectedFile, fileExtension);

CPH.SendMessage(chatMessage);
```

### **Phase 5: Testing & Validation** ⏱️ *10 minutes*
1. **Upload test files** with original names
2. **Run renamer tool** and verify secure naming
3. **Test StreamerBot actions** with manual triggers
4. **Verify chat links** work and display content
5. **Test spoofing protection** (try guessing URLs)

---

## 🔒 **Security Features**

### **Non-Spoofable URLs**
- **8-character random strings**: 36^8 = 2.8 trillion combinations
- **No sequential patterns**: Impossible to guess next/previous files
- **Extension preserved**: Maintains proper file type associations

### **Anti-Enumeration Protection**
- **No directory listing**: GitHub Pages doesn't expose folder contents
- **No manifest exposure**: `manifest.json` contains mappings but not predictable patterns
- **File count obfuscation**: Users can't determine total available rewards

### **Refresh Protection**
- **Direct file links**: URLs point to actual files, not dynamic generators
- **Static content**: No way to refresh for different results
- **Single-use immunity**: Each link is permanent and unchanging

---

## 📁 **File Type Support Matrix**

### **Supported Formats**
| Extension | Type | StreamerBot Handling | Chat Message |
|-----------|------|---------------------|--------------|
| `.png` | Image | Direct link | "🎨 Here's your follow reward: [link]" |
| `.jpeg/.jpg` | Image | Direct link | "🎨 Here's your follow reward: [link]" |
| `.webp` | Image | Direct link | "🎨 Here's your follow reward: [link]" |
| `.gif` | Animated | Direct link | "✨ Here's your animated follow reward: [link]" |
| `.mp4` | Video | Direct link | "🎬 Here's your video follow reward: [link]" |

### **Future Expansion Ready**
- Easy to add new formats by updating file scanner
- StreamerBot code designed for extensibility
- Manifest structure supports metadata expansion

---

## 🚀 **Workflow After Setup**

### **Adding New Rewards** ⏱️ *30 seconds*
1. **Drop files** into appropriate GitHub folder (any names)
2. **Visit** `https://kaypikefashion.github.io/stream-rewards/`
3. **Click** "Apply Changes" button
4. **Done** - StreamerBot automatically uses new files

### **No Manual Work Required**
- ✅ No file renaming
- ✅ No manifest editing  
- ✅ No StreamerBot configuration changes
- ✅ No link updates

---

## 📊 **Success Metrics**

### **Functionality Tests**
- [ ] Files renamed to secure format automatically
- [ ] Manifest.json generates correctly
- [ ] StreamerBot actions trigger on follows/subs
- [ ] Random file selection works
- [ ] Chat links post correctly
- [ ] All file types supported (png, jpeg, mp4, etc.)

### **Security Tests**
- [ ] URL guessing fails (test 100 random attempts)
- [ ] No directory browsing possible
- [ ] Refresh attacks don't work
- [ ] Sequential number attacks fail

### **Usability Tests**
- [ ] One-click file addition workflow works
- [ ] No technical knowledge required for maintenance
- [ ] Error messages are clear and helpful
- [ ] Works across different browsers

---

## ⚡ **Quick Start Checklist**

### **Initial Setup** ⏱️ *Total: ~60 minutes*
- [ ] Create `stream-rewards` GitHub repository
- [ ] Enable GitHub Pages
- [ ] Build `index.html` renamer tool
- [ ] Create StreamerBot Follow action
- [ ] Create StreamerBot Sub action  
- [ ] Test with sample files
- [ ] Verify security protections

### **Daily Operation** ⏱️ *Total: ~30 seconds*
- [ ] Drop new reward files in GitHub folders
- [ ] Click "Apply Changes" on website
- [ ] Confirm success message

---

## 🔄 **Version Control Protocol**

### **Version Numbering System:**
- **Major.Minor.Patch** format (e.g., 1.2.0)
- **Major:** Complete rewrites or architectural changes
- **Minor:** New features, significant improvements
- **Patch:** Bug fixes, small tweaks

### **Update Workflow:**
1. **Make changes** to index.html
2. **Increment version** in header with brief feature description
3. **Update plan document** if adding new features
4. **Test thoroughly** before committing to GitHub
5. **User can verify** page refresh by checking version number

### **Current Version History:**
- **v1.0.0:** Initial file renamer tool
- **v1.1.0:** Smart folder detection for nested structures  
- **v1.2.0:** Auto-save settings & browser storage
- **v1.2.1:** Improved error handling & debugging
- **v1.3.0:** Special high-value rewards folder support
- **v2.0.0:** Enterprise-grade batch processing for hundreds of files
- **v2.1.0:** Smart incremental processing (skip already-renamed files) ⭐

---

## 🎯 **Next Steps**
1. **Approve this plan** and overall approach
2. **Build index.html renamer tool** with GitHub API integration ✅
3. **Create StreamerBot C# code** for manifest parsing and random selection
4. **Test end-to-end workflow** with real files
5. **Deploy and validate security** against spoofing attempts

## ⚡ **Smart Incremental Processing (v2.1.0)**

### **Major Performance Optimization for Large Collections**

**Problem Solved:** Reprocessing hundreds of already-renamed files when adding just a few new ones.

**Solution:** Intelligent file detection that automatically skips already-secure files:

```yaml
detection_patterns:
  follows: "follow_[8_random_chars].[extension]"
  subs: "sub_[8_random_chars].[extension]"  
  special: "special_[8_random_chars].[extension]"

workflow_optimization:
  scan_phase: "Automatically detects renamed vs new files"
  processing_phase: "Only renames files that need renaming"
  manifest_phase: "Includes ALL files (renamed + preserved) for StreamerBot"

time_savings_examples:
  scenario_1: "314 renamed + 4 new files = Only 4 files processed (98% time savings)"
  scenario_2: "50 renamed + 10 new files = Only 10 files processed (83% time savings)"
  scenario_3: "All new files = No optimization (normal processing)"
```

### **User Experience Improvements**

**Visual Feedback:**
```
⚡ Smart Processing Optimization Active!
📊 Total files: 318
✅ Already securely named: 314 (will be preserved)
🔄 New files to rename: 4

💡 Processing time reduced by 98%!
```

**Button Updates:**
- Standard: "Apply Rename & Generate Manifest"  
- Optimized: "⚡ Smart Process (4 new files)"

### **Technical Implementation**

**Pattern Recognition:** Regex-based detection of secure naming patterns
**Manifest Integration:** Combines both preserved and newly-renamed files
**Error Isolation:** Failed renames don't affect preserved files
**Backwards Compatible:** Works with existing collections automatically

---

**Ready to proceed with implementation?**
